# 布局连线双向展示方案（2025-10）

## 设计要点
- 单条连接拆分为“上行/下行”两条平行轨道，通过 4~6px 的间距区分，保证双向同时可见。
- 轨道沿线稀疏布置箭纹（chevron），在无需查看端点的情况下即可快速识别数据流向。
- 使用状态色（绿色=在线，深灰=离线/未知，橙色=告警）统一渲染轨道、箭纹与带宽标签，维持视觉一致。
- 在轨道中段放置带宽胶囊标签：`↑120 Mb/s`、`↓95 Mb/s`；根据方向错位摆放，避免相互遮挡。
- 悬停某方向时加粗对应轨道、提高箭纹亮度，并在标签中显示更详细的统计信息（后续扩展）。
- 无带宽数据时隐藏标签，但仍保留方向箭纹，保持方向感。
- 无线链路保留虚线基底，强调无线特性，同时复用双轨结构。
- 断链/异常时仅高亮/警示对应方向的轨道与标签，降低误判。
- 在图例区展示双轨样式说明，并提供“仅看异常/隐藏带宽标签”等过滤开关，便于密集场景排查。

## 实施范围
1. 新增 `CanvasConnection` 的 `bandwidth`、`status` 等字段，支持上下行速率与状态标示。
2. `ConnectionLine` 组件重写为双轨渲染：两条 `Line` + 多个 `Arrow` + `Label/Tag/Text` 组合。
3. 辅助函数：按设备状态获取颜色（复用 `deviceVisual`），并计算方向向量、法向量及箭纹位置。
4. 交互：悬停/告警可针对某方向独立处理；右键菜单逻辑与设备节点保持一致。

## 交互说明
- **创建连线**：点击画布左上角的“连线模式”按钮后，依次点击起点与终点节点即可生成双向连线。
- **预览更新**：选定起点后，鼠标移动会实时绘制虚线箭头，方便确认终点。
- **取消/删除连线**：选定起点后拖动至空白释放即可取消当前操作；连线完成后可点击连线并使用面板按钮、`Delete` 或右键菜单删除。

## 验证建议
- 在画布上布置网桥 ↔ 网桥连接，确认双轨、箭纹、上下行标签全部显示，并随状态调色。
- 切换链路为无线类型，检查虚线效果仍与双轨兼容。
- 带宽缺失情况下确认只显示方向箭纹、无数值标签。
- 触发异常状态（告警/离线）观察颜色变化是否明显。
